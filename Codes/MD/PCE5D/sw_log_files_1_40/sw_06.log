# temperature
variable	T equal 300
#cold region temperature
#variable        tlo equal 275
variable        tlo equal ${T}-${L}*${cte}/4.0
variable        tlo equal 300-${L}*${cte}/4.0
variable        tlo equal 300-50*${cte}/4.0
variable        tlo equal 300-50*1.5938/4.0
#hot region temperature
#variable        thi equal ${cte}*${L}/2+${tlo}
variable        thi equal ${T}+${L}*${cte}/4.0
variable        thi equal 300+${L}*${cte}/4.0
variable        thi equal 300+50*${cte}/4.0
variable        thi equal 300+50*1.5938/4.0

#time step (picoseconds)
variable	dt equal 0.0005 # 0.5 femtoseconds
#number of time steps for NPT
variable	tnpt equal 5000
#number of time steps for NVT
variable	tnvt equal 40000
#number of time steps for first NVE
variable	t1nve equal 100000
#number of time steps for second NVE
variable	t2nve equal 500000

################### Variable Based on LAMMPS Documentation ######################
variable	a equal 100
variable	c equal ${t2nve}
variable	c equal 500000
variable	b equal $c/$a
variable	b equal 500000/$a
variable	b equal 500000/100
variable	tdamp equal ${dt}*100
variable	tdamp equal 0.0005*100
variable	pdamp equal ${dt}*1000
variable	pdamp equal 0.0005*1000

#----------------------------------------------------------------------------------------
# setup problem
dimension       3
boundary        p p p
atom_style      atomic
lattice 	diamond ${LC} origin 0.0 0.0 0.0 orient x 1 0 0 orient y 0 1 0 orient z 0 0 1
lattice 	diamond 5.43 origin 0.0 0.0 0.0 orient x 1 0 0 orient y 0 1 0 orient z 0 0 1
Lattice spacing in x,y,z = 5.43 5.43 5.43
region          0 block 0 $L 0 $W 0 $H units lattice side in
region          0 block 0 50 0 $W 0 $H units lattice side in
region          0 block 0 50 0 22 0 $H units lattice side in
region          0 block 0 50 0 22 0 22 units lattice side in
create_box      1 0
Created orthogonal box = (0 0 0) to (271.5 119.46 119.46)
  8 by 2 by 2 MPI processor grid
create_atoms    1 region 0
Created 193600 atoms
mass		1 28.0855
#dump		1 all xyz 1000 Si_W_${W}nm.xyz
#dump_modify	1 element Si

############################################
pair_style   sw
pair_coeff   * * Si${P}.sw Si
pair_coeff   * * Si6.sw Si
thermo		100
thermo_style custom step lx
min_style cg
minimize 0.0 1.0e-8 10000 100000
WARNING: Using 'neigh_modify every 1 delay 0 check yes' setting during minimization (../min.cpp:168)
Neighbor list info ...
  update every 1 steps, delay 0 steps, check yes
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 5.64718
  ghost atom cutoff = 5.64718
  binsize = 2.82359, bins = 97 43 43
  1 neighbor lists, perpetual/occasional/extra = 1 0 0
  (1) pair sw, perpetual
      attributes: full, newton on
      pair build: full/bin/atomonly
      stencil: full/bin/3d
      bin: standard
Per MPI rank memory allocation (min/avg/max) = 5.239 | 5.239 | 5.239 Mbytes
Step Lx 
       0        271.5 
       1        271.5 
Loop time of 0.041408 on 32 procs for 1 steps with 193600 atoms

73.8% CPU use with 32 MPI tasks x no OpenMP threads

Minimization stats:
  Stopping criterion = force tolerance
  Energy initial, next-to-last, final = 
        -667040.670628     -667040.670628     -667040.670628
  Force two-norm initial, final = 7.44001e-11 7.43497e-11
  Force max component initial, final = 4.31291e-13 4.33431e-13
  Final line search alpha, max atom move = 1 4.33431e-13
  Iterations, force evaluations = 1 2

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 0.024393   | 0.024763   | 0.025147   |   0.1 | 59.80
Neigh   | 0          | 0          | 0          |   0.0 |  0.00
Comm    | 0.006647   | 0.009802   | 0.01332    |   2.0 | 23.67
Output  | 0          | 0          | 0          |   0.0 |  0.00
Modify  | 0          | 0          | 0          |   0.0 |  0.00
Other   |            | 0.006843   |            |       | 16.53

Nlocal:    6050 ave 6050 max 6050 min
Histogram: 32 0 0 0 0 0 0 0 0 0
Nghost:    5892.5 ave 5893 max 5892 min
Histogram: 16 0 0 0 0 0 0 0 0 16
Neighs:    0 ave 0 max 0 min
Histogram: 32 0 0 0 0 0 0 0 0 0
FullNghs:  205700 ave 205700 max 205700 min
Histogram: 32 0 0 0 0 0 0 0 0 0

Total # of neighbors = 6582400
Ave neighs/atom = 34
Neighbor list builds = 0
Dangerous builds = 0
timestep     ${dt}
timestep     0.0005
velocity 	all create $T 492845
velocity 	all create 300 492845


fix 		NPT all npt temp $T $T ${tdamp} iso 0.0 0.0 ${pdamp}
fix 		NPT all npt temp 300 $T ${tdamp} iso 0.0 0.0 ${pdamp}
fix 		NPT all npt temp 300 300 ${tdamp} iso 0.0 0.0 ${pdamp}
fix 		NPT all npt temp 300 300 0.05 iso 0.0 0.0 ${pdamp}
fix 		NPT all npt temp 300 300 0.05 iso 0.0 0.0 0.5
thermo		100
thermo_style custom step lx press
run		${tnpt}
run		5000
Per MPI rank memory allocation (min/avg/max) = 4.114 | 4.114 | 4.114 Mbytes
Step Lx Press 
       1        271.5   -48363.182 
     100    268.37342   -18464.466 
     200    267.02355    -3399.988 
     300    266.70402    76.616071 
     400    266.71513    0.7235389 
     500    266.73437    3.3582043 
     600    266.73653    180.02465 
     700    266.75614   -150.57338 
     800    266.77163    162.27327 
     900    266.76924   -24.464315 
    1000    266.80515   -15.567899 
    1100     266.7961    55.250609 
    1200    266.81548    21.854236 
    1300    266.83209   -66.998529 
    1400    266.82469    92.227489 
    1500    266.84379    -92.37624 
    1600    266.83724    21.050727 
    1700    266.83206   -1.2679351 
    1800    266.83353   -29.349436 
    1900    266.83171   -6.6489571 
    2000    266.82663    32.865373 
    2100     266.8414   -49.174925 
    2200    266.82973    53.245767 
    2300    266.83927    -22.53271 
    2400    266.83195   -10.167584 
    2500     266.8301    29.142531 
    2600    266.83274   -18.128521 
    2700    266.83161    11.541301 
    2800    266.83684   -5.2587344 
    2900    266.83632   -10.597104 
    3000     266.8339    11.679244 
    3100    266.83333   -29.281117 
    3200     266.8267    23.015526 
    3300    266.83253    19.692627 
    3400    266.84173   -46.777683 
    3500    266.82961    33.165106 
    3600    266.83253    12.767972 
    3700    266.83892   -46.509977 
    3800    266.82171     63.16775 
    3900    266.83821    -26.04844 
    4000    266.83731   -32.447273 
    4100    266.82303    98.874656 
    4200     266.8504   -134.14355 
    4300    266.81618       120.17 
    4400    266.84392   -70.022961 
    4500    266.82732    11.764803 
    4600    266.83239    39.298114 
    4700    266.83851   -55.063574 
    4800    266.82899    36.308342 
    4900    266.83585   -2.0381427 
    5000    266.83383   -30.528429 
    5001    266.83397   -31.944532 
Loop time of 98.4877 on 32 procs for 5000 steps with 193600 atoms

Performance: 2.193 ns/day, 10.943 hours/ns, 50.768 timesteps/s
74.5% CPU use with 32 MPI tasks x no OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 56.495     | 58.092     | 63.393     |  15.8 | 58.98
Neigh   | 0.070146   | 0.074532   | 0.095786   |   1.4 |  0.08
Comm    | 14.259     | 23.9       | 28.715     |  76.8 | 24.27
Output  | 0.026318   | 0.030543   | 0.03216    |   1.0 |  0.03
Modify  | 11.178     | 15.151     | 20.365     |  86.7 | 15.38
Other   |            | 1.24       |            |       |  1.26

Nlocal:    6050 ave 6088 max 6005 min
Histogram: 2 3 1 3 5 2 6 5 2 3
Nghost:    5892.5 ave 5938 max 5854 min
Histogram: 2 3 5 5 3 5 2 2 3 2
Neighs:    0 ave 0 max 0 min
Histogram: 32 0 0 0 0 0 0 0 0 0
FullNghs:  206168 ave 207453 max 204606 min
Histogram: 2 3 1 3 4 3 5 6 2 3

Total # of neighbors = 6597372
Ave neighs/atom = 34.0773
Neighbor list builds = 6
Dangerous builds = 0
unfix		NPT
variable	length equal lx/${LC}
variable	length equal lx/5.43

################### Geometrical Parameters After Relaxation ###############################
# Thermostat_width
variable	TW equal ${length}/40
variable	TW equal 49.1406942323887/40
# Hot_Start
variable	hs equal ${length}/4-${TW}
variable	hs equal 49.1406942323887/4-${TW}
variable	hs equal 49.1406942323887/4-1.22851735580972
# Hot_End
variable	he equal ${length}/4+${TW}
variable	he equal 49.1406942323887/4+${TW}
variable	he equal 49.1406942323887/4+1.22851735580972
# Cold_Start
variable	cs equal 3*${length}/4-${TW}
variable	cs equal 3*49.1406942323887/4-${TW}
variable	cs equal 3*49.1406942323887/4-1.22851735580972
# Cold_End
variable	ce equal 3*${length}/4+${TW}
variable	ce equal 3*49.1406942323887/4+${TW}
variable	ce equal 3*49.1406942323887/4+1.22851735580972
###########################################################################################

################### Defining Thermostat ###################################################
region 		hot block ${hs} ${he} EDGE EDGE EDGE EDGE
region 		hot block 11.0566562022875 ${he} EDGE EDGE EDGE EDGE
region 		hot block 11.0566562022875 13.5136909139069 EDGE EDGE EDGE EDGE
region 		cold block ${cs} ${ce} EDGE EDGE EDGE EDGE
region 		cold block 35.6270033184818 ${ce} EDGE EDGE EDGE EDGE
region 		cold block 35.6270033184818 38.0840380301012 EDGE EDGE EDGE EDGE
group		test region cold
9572 atoms in group test
group		test1 region hot
9576 atoms in group test1
compute		Thot all temp/region hot
compute         Tcold all temp/region cold
###########################################################################################

fix		NVT all nvt temp $T $T ${tdamp}
fix		NVT all nvt temp 300 $T ${tdamp}
fix		NVT all nvt temp 300 300 ${tdamp}
fix		NVT all nvt temp 300 300 0.05
thermo		1000
thermo_style	custom step temp
run		${tnvt}
run		40000
Per MPI rank memory allocation (min/avg/max) = 4.118 | 4.12 | 4.121 Mbytes
Step Temp 
    5001    299.38222 
    6000    298.35093 
    7000    300.86494 
    8000    300.62761 
    9000    298.48017 
   10000    300.01398 
   11000     299.4395 
   12000    299.26429 
   13000    299.22589 
   14000    299.58904 
   15000    298.68285 
   16000    300.65279 
   17000    300.42459 
   18000     300.7767 
   19000    299.88529 
   20000    300.67601 
   21000    299.46369 
   22000    300.53728 
   23000    301.55863 
   24000    299.21683 
   25000    300.03849 
   26000    300.27683 
   27000    300.45976 
   28000    300.83527 
   29000    299.30531 
   30000    300.72043 
   31000    299.81666 
   32000    300.78058 
   33000    299.20958 
   34000    300.39465 
   35000    299.31191 
   36000    299.77521 
   37000    299.44017 
   38000    299.80004 
   39000    299.10632 
   40000    300.69782 
   41000     300.0313 
   42000    298.94621 
   43000    299.90405 
   44000     299.5542 
   45000    300.84066 
   45001    300.81273 
Loop time of 703.989 on 32 procs for 40000 steps with 193600 atoms

Performance: 2.455 ns/day, 9.778 hours/ns, 56.819 timesteps/s
79.1% CPU use with 32 MPI tasks x no OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 464.01     | 469.85     | 483.76     |  18.3 | 66.74
Neigh   | 0          | 0          | 0          |   0.0 |  0.00
Comm    | 97.183     | 149.86     | 192.34     | 223.2 | 21.29
Output  | 0.020358   | 0.023786   | 0.026184   |   1.0 |  0.00
Modify  | 30.415     | 70.635     | 112.52     | 308.7 | 10.03
Other   |            | 13.62      |            |       |  1.93

Nlocal:    6050 ave 6091 max 6003 min
Histogram: 1 3 1 5 5 4 5 2 4 2
Nghost:    5892.31 ave 5939 max 5851 min
Histogram: 2 4 2 5 4 5 4 2 2 2
Neighs:    0 ave 0 max 0 min
Histogram: 32 0 0 0 0 0 0 0 0 0
FullNghs:  208169 ave 209698 max 206493 min
Histogram: 2 2 1 5 5 5 5 1 4 2

Total # of neighbors = 6661414
Ave neighs/atom = 34.4081
Neighbor list builds = 0
Dangerous builds = 0
velocity	all scale $T
velocity	all scale 300
unfix		NVT

fix		NVE all nve
fix		hot all langevin ${thi} ${thi} ${tdamp} 389516 tally yes
fix		hot all langevin 319.9225 ${thi} ${tdamp} 389516 tally yes
fix		hot all langevin 319.9225 319.9225 ${tdamp} 389516 tally yes
fix		hot all langevin 319.9225 319.9225 0.05 389516 tally yes
fix_modify	hot temp Thot
fix		cold all langevin ${tlo} ${tlo} ${tdamp} 46579 tally yes
fix		cold all langevin 280.0775 ${tlo} ${tdamp} 46579 tally yes
fix		cold all langevin 280.0775 280.0775 ${tdamp} 46579 tally yes
fix		cold all langevin 280.0775 280.0775 0.05 46579 tally yes
fix_modify	cold temp Tcold

thermo_style	custom step temp c_Thot c_Tcold f_hot f_cold
run		${t1nve}
run		100000
Per MPI rank memory allocation (min/avg/max) = 4.868 | 4.87 | 4.871 Mbytes
Step Temp c_Thot c_Tcold f_hot f_cold 
   45001          300    300.60255    299.18449           -0           -0 
   46000    299.35525    316.22633    280.77683   -62.092673    55.120964 
   47000    299.27825    322.69372    281.87897   -83.344238     84.53214 
   48000      300.294    320.72655    282.99119   -91.059644    91.451811 
   49000    299.16276    317.85175    278.47609   -119.42708    121.87646 
   50000    299.90822    322.77429    279.48844   -147.90813    135.88627 
   51000    298.54318    317.63302    278.01333   -153.40871    151.03397 
   52000    299.34229    319.63893    282.27608   -183.24553     167.9696 
   53000    299.84412    321.62685    286.29452   -212.71404    185.54432 
   54000    298.99779     319.1073    277.22767   -217.67839    223.59715 
   55000    299.51052    321.27421    275.94483   -250.10321    243.85899 
   56000    299.10272    319.21619    282.16321   -268.34913    256.54118 
   57000    299.54437    315.81284    283.71862   -291.18148    284.74307 
   58000    298.68249    317.93559    283.54141   -317.82579    299.55787 
   59000    299.18984    315.63161    280.34413   -340.40109    333.62712 
   60000    299.27397    316.60045    276.35818   -375.53914    361.84439 
   61000    299.72976    315.64129     280.5365   -411.06392     390.6581 
   62000    299.62946    318.43428    281.17818   -433.53499    418.47314 
   63000    300.02895    319.29908    282.62229   -464.65707    437.85193 
   64000    299.97871    321.69555    277.84131   -489.81982    470.96913 
   65000    299.55727    320.25676    281.07716   -513.57482    496.52504 
   66000    299.41072    313.05961    278.33105   -534.52445    533.35247 
   67000    299.44311    319.96961    284.04429   -573.74827    558.82933 
   68000    299.48237    315.46133     277.6297   -600.68174    592.54144 
   69000    299.03422    319.74138    279.91955   -634.87579    607.05017 
   70000    299.52772    318.48612    277.82347   -651.09443    636.02301 
   71000    300.23718    319.52089    286.27122   -682.66246    656.48015 
   72000    299.63644    321.04458    279.87907   -716.88226    685.01987 
   73000    299.64625    319.96045    281.06575   -740.52095    724.17084 
   74000    300.51314    321.43785    286.06337   -779.33419    750.61223 
   75000    299.66253    324.60868    279.97035   -808.36782    784.47353 
   76000    299.42813    317.89957    281.82099   -821.97858     817.2948 
   77000    298.75797    319.29385    280.68309   -854.99076    847.68351 
   78000    299.44403    317.91752     279.5729   -879.42687    882.68684 
   79000    299.33367    317.76473    280.14387   -902.50705    905.75314 
   80000    299.50574    321.52107    280.63686   -941.84544    929.04949 
   81000    299.58681    319.58094    277.26684   -966.28223    962.06181 
   82000    298.84092    322.46951     278.4655   -1006.8114    982.61623 
   83000    299.43685     321.5088    284.74421   -1030.1899    1003.9871 
   84000     299.9329    318.37417    281.29156   -1064.6269    1034.8568 
   85000    298.89163     317.1066     276.5014   -1082.3524    1077.3847 
   86000    299.36689    315.89546     280.0271   -1113.9197    1104.4456 
   87000     299.3155    313.86508    280.81244   -1143.9098    1128.1497 
   88000     298.8731    316.61424    279.41474   -1177.3546    1166.1415 
   89000    298.62327    318.37172    281.09047   -1206.7193    1187.1785 
   90000    299.35672    314.66916    282.55815   -1224.8869    1220.6688 
   91000    298.82977    323.47998    281.84716   -1255.3997    1261.2179 
   92000    299.96859    321.80798    285.07162   -1282.0059    1285.9125 
   93000     299.2258     322.7179    278.65239   -1313.9151    1314.8526 
   94000    299.89243    321.06057    282.79831   -1348.9132    1331.2238 
   95000    299.45443    320.03229    276.61435   -1372.7414    1372.7452 
   96000    299.13804    315.86516     278.6785   -1398.9714    1396.8569 
   97000    298.94382     320.5445    280.79552   -1444.6602     1431.622 
   98000    299.49866     319.0491    282.06556   -1464.6031    1465.7262 
   99000     299.6283    319.00237    280.78351   -1495.4382    1486.8546 
  100000    299.96146    321.99141    284.17734   -1533.0363    1507.4568 
  101000    299.74941    318.37782     281.1982   -1559.3398     1539.328 
  102000    299.87912    317.95909    283.72858   -1593.1597    1550.9345 
  103000    299.31771    314.13799    283.05975   -1617.8077    1589.8547 
  104000    300.82386    323.69808    279.36592   -1665.3884    1623.9687 
  105000    299.63496    318.99622    281.52007   -1687.7499    1657.0385 
  106000    299.30632     314.8166    282.87466    -1707.512    1685.7007 
  107000     299.8113    321.79696    276.99074   -1737.7399    1717.6326 
  108000    300.40876    313.54797    281.48977   -1763.3883    1730.6676 
  109000    299.86092    319.13713    285.63511   -1794.8968    1769.1926 
  110000    299.68626    317.93134    280.40331   -1822.4056    1797.1664 
  111000    299.98465    320.46456    280.84012   -1856.0856    1833.5443 
  112000    299.49338    319.50517    280.80341   -1876.8631    1856.1328 
  113000    299.71362    322.23446      277.784   -1908.2853    1888.6702 
  114000    300.35914    319.94901    279.40909   -1938.9953    1903.1829 
  115000    300.54528    315.65082    282.35546   -1956.8778    1930.6672 
  116000    299.95216    318.70048    280.83541   -1993.7911    1952.3192 
  117000    299.43149    315.60014    283.11658    -2011.725    1988.7365 
  118000    299.61361    313.86055    278.72904   -2058.3732     2011.457 
  119000    299.87886    318.70105    279.90939   -2078.9479    2042.8276 
  120000    300.30873    322.21111    284.96388    -2118.138    2064.2868 
  121000    299.71378    318.64975    279.55193   -2133.1347    2099.7493 
  122000    300.25441    320.99706    283.53598   -2164.1154    2127.5607 
  123000    299.60121    316.77879    285.20934   -2182.0408     2157.756 
  124000    299.73774    313.62182    283.82001   -2209.6096    2179.1531 
  125000    300.14565    313.92391     287.6988   -2234.5917    2203.3002 
  126000    299.77493    316.57936    282.12553   -2264.9036    2239.0175 
  127000      299.884    323.92589    279.01747   -2303.5459    2284.7565 
  128000    299.92092    317.74767    284.30123   -2327.3936    2290.9214 
  129000     301.0747    321.07125    281.44134   -2368.6083    2330.6401 
  130000    300.23062    318.05941    279.96842   -2391.0332    2344.1768 
  131000    300.50732    320.52981    284.89123   -2415.6242    2368.9387 
  132000    300.04832    318.64461    280.03133   -2442.6691    2396.1519 
  133000    300.49195    317.84551    284.28958    -2481.152    2417.0128 
  134000    299.76038    316.88116    284.32378   -2499.7256    2439.5325 
  135000    300.18536    321.60217    281.12107    -2533.513    2474.3471 
  136000    300.69262    314.41907    281.41397   -2558.2855    2505.7362 
  137000    300.03238    317.11053    282.33376   -2585.5516    2529.8866 
  138000    300.20651    318.51673    283.01913   -2617.4604    2561.0172 
  139000    299.92878    316.47572     279.7455   -2635.8516    2597.4199 
  140000    300.21217    320.61288    280.62229   -2673.0774    2621.0537 
  141000    299.68882    317.43253    282.13631   -2701.4084    2653.4922 
  142000    300.35641    318.60385    278.16849    -2728.418     2684.933 
  143000    300.34444    315.26435    277.17581   -2759.5503    2712.3647 
  144000    300.07159    320.39675    281.96437   -2800.8838    2742.1317 
  145000    299.97139    319.32942       278.95   -2820.0043    2771.5878 
  145001    299.99689    319.45312    279.68993   -2820.1738    2770.7115 
Loop time of 1895.15 on 32 procs for 100000 steps with 193600 atoms

Performance: 2.280 ns/day, 10.529 hours/ns, 52.766 timesteps/s
79.5% CPU use with 32 MPI tasks x no OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 1159.4     | 1180       | 1202.4     |  32.5 | 62.26
Neigh   | 0          | 0          | 0          |   0.0 |  0.00
Comm    | 270.84     | 384.66     | 495.08     | 357.8 | 20.30
Output  | 0.097865   | 0.10291    | 0.10576    |   0.7 |  0.01
Modify  | 198.37     | 303        | 412.88     | 378.7 | 15.99
Other   |            | 27.43      |            |       |  1.45

Nlocal:    6050 ave 6105 max 5995 min
Histogram: 1 2 2 5 5 8 1 5 0 3
Nghost:    5892.34 ave 5948 max 5837 min
Histogram: 3 0 5 1 8 5 4 3 2 1
Neighs:    0 ave 0 max 0 min
Histogram: 32 0 0 0 0 0 0 0 0 0
FullNghs:  208175 ave 210170 max 206099 min
Histogram: 1 1 3 5 4 8 3 3 1 3

Total # of neighbors = 6661594
Ave neighs/atom = 34.4091
Neighbor list builds = 0
Dangerous builds = 0

# thermal conductivity calculation
# reset langevin thermostats to zero energy accumulation
reset_timestep 0
thermo		$c
thermo		500000
compute		ke all ke/atom
variable	temp atom c_ke/1.5/8.617332478e-5
fix		hot all langevin ${thi} ${thi} ${tdamp} 389516 tally yes
fix		hot all langevin 319.9225 ${thi} ${tdamp} 389516 tally yes
fix		hot all langevin 319.9225 319.9225 ${tdamp} 389516 tally yes
fix		hot all langevin 319.9225 319.9225 0.05 389516 tally yes
fix_modify	hot temp Thot
fix		cold all langevin ${tlo} ${tlo} ${tdamp} 46579 tally yes
fix		cold all langevin 280.0775 ${tlo} ${tdamp} 46579 tally yes
fix		cold all langevin 280.0775 280.0775 ${tdamp} 46579 tally yes
fix		cold all langevin 280.0775 280.0775 0.05 46579 tally yes
fix_modify	cold temp Tcold

compute		ch all chunk/atom bin/1d x lower 0.02 units reduced
fix		11 all ave/chunk $a $b $c ch v_temp file sw_${P}.langevin
fix		11 all ave/chunk 100 $b $c ch v_temp file sw_${P}.langevin
fix		11 all ave/chunk 100 5000 $c ch v_temp file sw_${P}.langevin
fix		11 all ave/chunk 100 5000 500000 ch v_temp file sw_${P}.langevin
fix		11 all ave/chunk 100 5000 500000 ch v_temp file sw_6.langevin
thermo_style	custom step temp c_Thot c_Tcold f_hot f_cold

run		${t2nve}
run		500000
Per MPI rank memory allocation (min/avg/max) = 5.118 | 5.12 | 5.121 Mbytes
Step Temp c_Thot c_Tcold f_hot f_cold 
       0    299.99689    319.47293    279.59418           -0           -0 
  500000    300.51522    311.80828    281.26623   -13789.404    13800.018 
Loop time of 9497.18 on 32 procs for 500000 steps with 193600 atoms

Performance: 2.274 ns/day, 10.552 hours/ns, 52.647 timesteps/s
79.6% CPU use with 32 MPI tasks x no OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 5796.6     | 5905.8     | 6008.2     |  67.8 | 62.18
Neigh   | 0          | 0          | 0          |   0.0 |  0.00
Comm    | 1344.7     | 1937.2     | 2471.4     | 780.4 | 20.40
Output  | 0.034604   | 5.5443     | 6.5216     |  61.6 |  0.06
Modify  | 985.53     | 1511.3     | 2054       | 849.1 | 15.91
Other   |            | 137.3      |            |       |  1.45

Nlocal:    6050 ave 6084 max 6010 min
Histogram: 1 1 5 5 2 4 3 7 2 2
Nghost:    5890.25 ave 5930 max 5857 min
Histogram: 2 4 7 1 2 4 6 3 2 1
Neighs:    0 ave 0 max 0 min
Histogram: 32 0 0 0 0 0 0 0 0 0
FullNghs:  208248 ave 209419 max 206674 min
Histogram: 1 2 3 2 6 4 1 3 8 2

Total # of neighbors = 6663938
Ave neighs/atom = 34.4212
Neighbor list builds = 0
Dangerous builds = 0
clear
next		P
jump		Si.in
 units       metal
#----------------------------- User Input Variables --------------------------------------
################### Geometrical Parameters ###############################
variable	P index 5 6 7 8
variable	W equal 22
# Lattice Constant
variable	LC equal 5.43
# Length
variable	L equal 50
# Width
#variable	W equal 6
# Height
variable	H equal ${W}
variable	H equal 22
################### Simulation Condition ###############################
#DT/DX=cte
variable	cte equal 1.5938
log         sw_${P}.log
log         sw_7.log
