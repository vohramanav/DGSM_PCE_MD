\section{Methodology}
\label{sec:method}

%Stage1: QoI selection for accurate estimation of derivatives and PCE, Stage 2: Parameter Screening, Stage 3: Reduced-order Surrogate Verification
%
%1. Goal is to estimate the upper bound on Sobol total-effect index using DGSM. 
%2. QoI should be differentiable w.r.t all the parameters. 
%3. Derivative could be estimated analytically or numerically.
%4. The expected value of the partial derivative w.r.t a given parameter is approximated over a few samples.
%5. Gradually enhance the sample size until some degree of convergence is established.
%6. Note that model runs at the full parameter space will be used for verification of the ROS. However, one could consider
%relaxing the convergence criterion to reduce computational costs. 
%7. Consider the product of Ci and mu_i to screen parameters.i

In this section, we outline the underlying methodology for constructing a 
reduced-order surrogate using sensitivity analysis. The term `reduced-order'
in the present context implies that the surrogate is constructed in a 
subspace that sufficiently captures the uncertainty in the model output. 
For instance, in the case of PC surrogates, the dimensionality of the polynomial
basis functions is effectively reduced. A possible approach to 
constructing a reduced-order surrogate involves sensitivity analysis of the
uncertain model parameters with respect to a given output, and thereby
disregarding the uncertainty associated with parameters considered as unimportant.
For this purpose, a global sensitivity analysis based on Sobol indices could be pursued.
However, as discussed earlier in sections~\ref{sec:intro} and~\ref{sec:bg}, determining converged 
estimates of Sobol sensitivity indices typically requires tens of thousands
of model evaluations. Consequently, the exercise becomes prohibitive in
situations where the model runs are compute-intensive. Instead, we estimate a normalized
upper-bound ($\widehat{\mathcal{C}_i\mu_i}$, see Eq.~\ref{eq:bound}) on the Sobol total
effect index ($\mathcal{T}(\theta_i)$) for each parameter, $\theta_i$, and use it as a 
metric to identify the unimportant parameters. Below, we provide an algorithm for 
parameter screening. It is assumed that the partial derivatives in Eq.~\ref{eq:mu}
are estimated using finite difference. 

\bigskip

\begin{breakablealgorithm}
  \caption{Parameter screening with derivative-based sensitivity measures.}
  \begin{algorithmic}[1]
    \Procedure{Screening}{}
      \State Generate $n_1$ points in $\mathbb{R}^{d}$.\Comment{$d$: 
             Number of uncertain model parameters.}
      \State Perturb each point along the $d$ directions to obtain a set of $n_1(d+1)$ points.
      \State Compute $\mu_i$ using model evaluations at the $n_1(d+1)$ points in Eq.~\ref{eq:mu}
      \State Determine initial ranks, $\mathcal{R}^{old}$ based on $\widehat{\mathcal{C}_i\mu_i}$ values for $\theta_i$.
      \State set $k$ = 1\Comment{Iteration counter}
      \Do
        \State Generate $n_k$ new points in $\mathbb{R}^{d}$.
        \State Perturb each point along the $d$ directions to obtain a set of $n_k(d+1)$ points.
        \State Compute and store model evaluations at the $n_k(d+1)$ points.
        \State Compute $\mu_i$ using prior model evaluations at $(d+1)(n_1 + \sum_j^k n_j)$ points.
        \State Determine new ranks, $\mathcal{R}^{new}$ based on updated $\widehat{\mathcal{C}_i\mu_i}$ values.
        \State Compute $max\_pdev$ = max$\left(\frac{|\mu_{i,k} - 
               \mu_{i,k-1}|}{ \mu_{i,k-1}}\right)$.\Comment{$max\_pdev$:
               Maximum percentage deviation in $\mu_i$ between successive iterations.}
        \State set $k$ = $k$ + 1
      \doWhile{($\mathcal{R}^{\tiny{new}}$ $\neq$ $\mathcal{R}^{\tiny{old}}$ {\bf or}  
               $max\_pdev$~$>~\tau$)\Comment{$\tau$:~Tolerance}}
    \EndProcedure
  \end{algorithmic}
\end{breakablealgorithm}

\bigskip

Based on the steps outlined in the above algorithm, it can be said that the set of sample points used for
estimating the screening metric, $\widehat{\mathcal{C}_i\mu_i}$ is enriched until consistency in ranks
between successive iterations as well as a certain degree of convergence in estimates of the screening 
metric for each uncertain parameter is accomplished. Parameter
screening is an integral part of the overall strategy for constructing the reduced-order surrogate as 
depicted below using a flow-diagram. 

\bigskip



\begin{figure}[htbp]
\begin{center}
\begin{tikzpicture}[node distance=1.5cm]

\node (start) [startstop] {Start};

\node (qoi) [io, below of=start,align=left] {Select an appropriate model output};

\draw [line] (start) -- (qoi);

\node (tol) [io, below of=qoi, text width=7em,align=left,yshift=-0.2cm] {Set an initial tolerance, $\tau$};

\draw [line] (qoi) -- (tol);

\node (screen) [process, below of=tol, text width=9.5em] {Parameter Screening};

\draw [line] (tol) -- (screen);

\node (dr) [draw, diamond, aspect=1.5,yshift=-6.7cm, text width=4.5em, text centered] {Is DR possible$?$};

\draw [line] (screen) -- (dr);

\node (res) [draw, diamond, aspect=1.5, xshift=4.5cm,text width=4.5em, text centered, right of=dr] {Resource available$?$};

\draw [line] (dr) -- node[anchor=south] {N} (res);

\node (dtol) [io, above of=res, text width=6em,align=left,yshift=1.2cm,text centered]
 {\vspace{-5mm}\be\tau = \tau - \delta\tau,~\delta\tau > 0\nonumber\ee};
 
\draw [line] (dtol) -| (screen);
 
 \draw [line] (res) -- node[anchor=west,yshift=-0.1cm] {Y} (dtol);

\node (ros) [process, below of=dr, text width=11em,yshift=-1.2cm] {Construct a reduced-order surrogate};

\draw [line] (dr) -- node[anchor=east] {Y}(ros);

\node (verify) [process, below of=ros, text width=9em,yshift=-0.2cm] {Verify accuracy of the surrogate};

\draw [line] (ros) -- (verify);

\node (stop) [startstop, below of=verify] {Stop};

\draw [line] (verify) -- (stop);

\draw [line] (res) |- node[anchor=east,yshift=4.3cm] {N} (stop);


\end{tikzpicture}
\end{center}

\caption{Flow-diagram outlining the overall strategy for constructing reduced-order surrogates using
the derivative-based sensitivity measures. Note that DR is an abbreviation for dimension reduction.}
\end{figure}

As illustrated in the above flow-diagram, application of the above methodology to construct a reduced-order
surrogate relies on the choice of an \textit{appropriate} model output. Since the parameters are screened
using derivative-based sensitivity measures, the model output should exhibit a smooth dependence on the
individual uncertain parameters to enable a reasonable approximation of the derivatives in Eq.~\ref{eq:mu}.
Hence, for a given problem involving multiple outputs or model predictions, it is likely that a reduced-order 
surrogate might be possible for only selected outputs. Hence, where possible, it is recommended to a priori assess the
nature of dependence of a given model output on the parameters.





 
